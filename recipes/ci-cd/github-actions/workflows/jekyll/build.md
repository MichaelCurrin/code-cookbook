---
description: Build a Jekyll site in GH Actions
---
# Build

{% raw %}

Related Cookbook pages:

- [GH Pages Actions][] page in this Jekyll section.
- [Deploy GH Pages][] as a more generic section which could still be used for Jekyll.
- [Jekyll container][] page.

[GH Pages Actions]: {{ site.baseurl }}{% link recipes/ci-cd/github-actions/workflows/jekyll/gh-pages-actions.md %}
[Deploy GH Pages]: {{ site.baseurl }}{% link recipes/ci-cd/github-actions/workflows/deploy-gh-pages/index.md %}
[Jekyll container]: {{ site.baseurl }}{% link recipes/containers/jekyll.md %}


## Samples

### Jekyll in a container

This flow runs a Docker container with Ruby and Jekyll inside as a binary container - so it can be used as a drop-in replacement for running `jekyll` directly. Plus the container takes care of Ruby and Jekyll dependencies and installing project dependencies. I end the workflow by deploy the `_site` directory generated by the build step as a GH Pages site.

Rather than putting code here, I'm going to link to the workflow that is actually in use:

- [main.yml](https://github.com/MichaelCurrin/jekyll-gh-actions-quickstart/blob/main/.github/workflows/main.yml)

#### Links

See my Jekyll GH Actions Quickstart template project which demonstrates how to build a minimal site. It has a GH Actions flow which uses Docker + Jekyll in one step and GH Pages deploy in the last step.

- [![MichaelCurrin - jekyll-gh-actions-quickstart](https://img.shields.io/static/v1?label=MichaelCurrin&message=jekyll-gh-actions-quickstart&color=blue&logo=github)](https://github.com/MichaelCurrin/jekyll-gh-actions-quickstart)
- [Live demo](https://michaelcurrin.github.io/jekyll-gh-actions-quickstart/) website.

#### About the approach

This builds the site using a **Docker** container step. This means you don't need to use any Action from the marketplace to setup your Ruby and Jekyll environment. The container image is ready to go. When you run it, it will even install your gems for you using Bundler.

I think this is great - I don't know why there are so many Jekyll actions out there. Maybe if you really need control over the environment or build steps. Some actions include Jekyll and GH Pages in one - I don't think it is a good idea to mix those together in one inseparable step.

Another advantage is that you can run the exact same container locally - which is great for debugging and for running your application locally on any OS without requiring Ruby, Bundler and gems installed.

#### Notes on the workflow

- Using the Docker step alone output would get thrown away after the build. If you want to persist as a GH Pages site, just add on the last section as below, using a generic GH Pages action.
- You can pick a tag like `4` to get a recent version in `4.x` range. I'd avoid `latest` as one day you'll suddenly get `5`. GH Pages normally limits you to `3.9`.
- The `--future` flag is to publish futured-dated posts.

#### About the approach

The workflow is based on the one generated by the GitHub when it suggests a Jekyll workflow for your project.

My additions:

- Use Jekyll version `4` instead of `latest` for more control.
- Add GH Pages at the end to persist on `gh-pages` branch. I've also setup this deploy step only runs on the main branch, not feature branches.

#### Volume note

Note that GitHub's own starter workflow mounts **two** volumes, when only one is needed.

Here it is anyway:

```
-v ${{ github.workspace }}:/srv/jekyll \
-v ${{ github.workspace }}/_site:/srv/jekyll/_site \
```

The second is unnecessary as it is already covered by the first as a nested directory with the identical name in and outside the container.

### Jekyll Action TS

- [![limjh16 - jekyll-action-ts](https://img.shields.io/static/v1?label=limjh16&message=jekyll-action-ts&color=blue&logo=github)](https://github.com/limjh16/jekyll-action-ts)

This is fork of [Jekyll Actions](https://github.com/marketplace/actions/jekyll-actions) action, except this one doesn't seem to publish for you. Which is fine as it means this Jekyll action has a narrow scope and it is also easy to add an extra step to publish to GH Pages. The docs recommend a popular action by PeaceIris, as shown in the last step below.

It appears you have to first setup Ruby and then use this Jekyll-related action.

This uses TypeScript instead of Docker, so is supposed should be quicker to download than the original action. It also is more flexible to handle non-default use-cases.

Sample usage based on the docs.

- `main.yml`
    ```yaml
    name: Build and deploy

    on:
      push:
        branches:
          - master

    jobs:
      jekyll:
        runs-on: ubuntu-latest

        steps:
          - name: Checkout ðŸ“‚
            uses: actions/checkout@v2

          - name: Setup Ruby ðŸ’Ž
            uses: ruby/setup-ruby@v1
            with:
              ruby-version: 2.7

          - name: Install dependencies and build site ðŸ”¨
            uses: limjh16/jekyll-action-ts@v2
            with:
              enable_cache: true

          - name:  Deploy ðŸš€
            if: ${{ github.event_name != 'pull_request' }}
            uses: peaceiris/actions-gh-pages@v3
            with:
              github_token: ${{ secrets.GITHUB_TOKEN }}
              publish_dir: _site
    ```

{% endraw %}
